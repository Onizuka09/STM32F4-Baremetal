# SPI: Serial peripheral Interface 
* It's a Communication Protocol 
Syncronous full and full duplex communication, between master and several slave 
It has 4 pins in total
Uses 2 pins for Data transfer SDIN and SDO 
uses a CLK pin to synchronize data transfer
There is CE pin which is used to initiate and terminate the data transfer
SDI: MOSI: send data from master to slave  
SDO: MISO: send data from slave to master 
SCLK:SCK : synchronize data transfer, generated by master. 
CE:SS: slave select (GPIO output pin) 
Note 
Multiple slave(3)
+--------|----------------------+
| Master | Slave                |
+========|======================+
| SCL    | SCLx: x from 1 to 4  |
| MOSI   | MOSIx: x from 1 to 4 |
| MISO   | MISOx: x from 1 to 4 |
| SS1    | SS1                  |
| SS2    | SS2                  |
| SS3    | SS3                  |
+--------|----------------------+
## How it works 
* enabling clokc 
* set the SS line to low
* data is shifted in the master register (DR) with the MSB first , while shifting a new LSB to the same register 
* At the same time data from the slave is shifted into the LSB of the register 
* by the ned of shifting all registers bits out and in, the master and slave data would be exchanged 
* if more data needs to be exchanged, the shift register will be reloaded and the process of exchange start again 
* when no ddata need to be transmitted, the master stops SLC and set SS to High
## Clock and phase polarity 
Master an dslave must agree on clock phase and polarity 
CPOL: clock polarity 
CPHA: clock phase 
Combibnations of CPOL and CPHA are referred to as Bus modes. 

| Mode   | CPOL | CPHA | Result                              |
+========|======|======|=====================================+
| Mode 0 | 0    | 0    | data is capture on the rising edge  |
|        |      |      | data is output on the falling edge  |
+--------|------|------|-------------------------------------+
| Mode 1 | 0    | 1    | data is capture on the falling edge |
|        |      |      | data is output on the rising edge   |
+--------|------|------|-------------------------------------+
| Mode 2 | 1    | 0    | data is capture on the rising edge  |
|        |      |      | data is output on the falling edge  |
+--------|------|------|-------------------------------------+
| Mode 3 | 1    | 1    | data is capture on the rising edge  |
|        |      |      | data is output on the falling edge  |
+--------|------|------|-------------------------------------+

| CPOL = 0                  | CPOL = 1                   |
+---------------------------|----------------------------+
| Active state of clock = 1 | Active state of clock is 0 |
| Idle state oc clock is 0  | Idle state of clk i 1      |
+---------------------------|----------------------------+

* CPOL 0: Means smpling on the fisrt edge (rising) 
* CPOL 1: Means smapling on the second edge (falling) 
## NSS Management 
* NSS Software mode 
SS line driven internally by the firmware 
* NSS Hardware mode 
A dedicated GPIO pin is used to dirve the SS line 
    - NSS OUPUT Enabled 
        Used only when device operetes in master mdoe 
    - NSS Output Disabled 
        Allows multi-master capability for devices operating in master mode 
* TI mode 
NSS Hardware mode must be used 
CPHA and CPOL are forced to conform to Texas Instrument (TI) protocole requirements
In this mode NSS signal pulses at the end of every transmitted byte. 
## Programming: 
we be using SPI 1 connected APB2 bus
 alterante function type: AF05   
SPI1_MOSI: PA7
smpi1_Miso : PA6
SPI1_SCK : 
SPI1_SS : PA9
